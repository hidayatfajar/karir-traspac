function e(){return e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},e.apply(this,arguments)}function t(e,t){if(e.length!==t.length)throw new Error("vectors must be same length");return e.map(function(e,n){return e+t[n]})}function n(e){return Math.max.apply(Math,e.map(Math.abs))}function i(e){return Object.freeze(e),Object.values(e).forEach(function(e){null===e||"object"!=typeof e||Object.isFrozen(e)||i(e)}),e}var o=[1,18,"undefined"!=typeof window&&window.innerHeight||800];var r=[-1,-1,-1];var a=function(t){return e({},t,{axisDelta:t.axisDelta.map(function(e){return t=e,n=-700,i=700,Math.min(Math.max(n,t),i);var t,n,i})})},s=i({preventWheelAction:!0,reverseSign:[!0,!0,!1]});function u(u){void 0===u&&(u={});var c,l,m=function(){var e={};function t(t,n){e[t]=(e[t]||[]).filter(function(e){return e!==n})}return i({on:function(n,i){return e[n]=(e[n]||[]).concat(i),function(){return t(n,i)}},off:t,dispatch:function(t,n){t in e&&e[t].forEach(function(e){return e(n)})}})}(),f=m.on,v=m.off,d=m.dispatch,h=s,p={isStarted:!1,isStartPublished:!1,isMomentum:!1,startTime:0,lastAbsDelta:1/0,axisMovement:[0,0,0],axisVelocity:[0,0,0],accelerationFactors:[],scrollPoints:[],scrollPointsToMerge:[],willEndTimeout:400},M=!1,g=function(e){Array.isArray(e)?e.forEach(function(e){return E(e)}):E(e)},x=function(t){return void 0===t&&(t={}),Object.values(t).some(function(e){return null==e})?h:h=i(e({},s,h,t))},b=function(n){var i=e({event:c,isStart:!1,isEnding:!1,isMomentumCancel:!1,isMomentum:p.isMomentum,axisDelta:[0,0,0],axisVelocity:p.axisVelocity,axisMovement:p.axisMovement,get axisMovementProjection(){return t(i.axisMovement,i.axisVelocity.map(function(e){return void 0===t&&(t=.996),e*t/(1-t);var t}))}},n);d("wheel",e({},i,{previous:l})),l=i},E=function(i){var s,u,l,m,f=a(function(t,n){if(!n)return t;var i=!0===n?r:n.map(function(e){return e?-1:1});return e({},t,{axisDelta:t.axisDelta.map(function(e,t){return e*i[t]})})}((u=(s=i).deltaX*o[s.deltaMode],l=s.deltaY*o[s.deltaMode],m=(s.deltaZ||0)*o[s.deltaMode],{timeStamp:s.timeStamp,axisDelta:[u,l,m]}),h.reverseSign)),v=f.axisDelta,d=f.timeStamp,g=n(v);i.preventDefault&&function(e,t){var n=h.preventWheelAction,i=t[0],o=t[1],r=t[2];if("boolean"==typeof n)return n;switch(n){case"x":return Math.abs(i)>=e;case"y":return Math.abs(o)>=e;case"z":return Math.abs(r)>=e;default:return!1}}(g,v)&&i.preventDefault(),p.isStarted?p.isMomentum&&g>Math.max(2,2*p.lastAbsDelta)&&(L(!0),A()):A(),0===g&&Object.is&&Object.is(i.deltaX,-0)?M=!0:(c=i,p.axisMovement=t(p.axisMovement,v),p.lastAbsDelta=g,p.scrollPointsToMerge.push({axisDelta:v,timeStamp:d}),w(),b({axisDelta:v,isStart:!p.isStartPublished}),p.isStartPublished=!0,j())},w=function(){var e;2===p.scrollPointsToMerge.length?(p.scrollPoints.unshift({axisDeltaSum:p.scrollPointsToMerge.map(function(e){return e.axisDelta}).reduce(t),timeStamp:(e=p.scrollPointsToMerge.map(function(e){return e.timeStamp}),e.reduce(function(e,t){return e+t})/e.length)}),D(),p.scrollPointsToMerge.length=0,p.scrollPoints.length=1,p.isMomentum||T()):p.isStartPublished||S()},S=function(){var e;p.axisVelocity=(e=p.scrollPointsToMerge,e[e.length-1]).axisDelta.map(function(e){return e/p.willEndTimeout})},D=function(){var e=p.scrollPoints,t=e[0],n=e[1];if(n&&t){var i=t.timeStamp-n.timeStamp;if(!(i<=0)){var o=t.axisDeltaSum.map(function(e){return e/i}),r=o.map(function(e,t){return e/(p.axisVelocity[t]||1)});p.axisVelocity=o,p.accelerationFactors.push(r),y(i)}}},y=function(e){var t=10*Math.ceil(e/10)*1.2;p.isMomentum||(t=Math.max(100,2*t)),p.willEndTimeout=Math.min(1e3,Math.round(t))},P=function(e){return 0===e||e<=.96&&e>=.6},T=function(){if(p.accelerationFactors.length>=5){if(M&&(M=!1,n(p.axisVelocity)>=.2))return void O();var e=p.accelerationFactors.slice(-5);e.every(function(e){var t=!!e.reduce(function(e,t){return e&&e<1&&e===t?1:0}),n=e.filter(P).length===e.length;return t||n})&&O(),p.accelerationFactors=e}},O=function(){p.isMomentum=!0},A=function(){(p={isStarted:!1,isStartPublished:!1,isMomentum:!1,startTime:0,lastAbsDelta:1/0,axisMovement:[0,0,0],axisVelocity:[0,0,0],accelerationFactors:[],scrollPoints:[],scrollPointsToMerge:[],willEndTimeout:400}).isStarted=!0,p.startTime=Date.now(),l=void 0,M=!1},j=function(){var e;return function(){clearTimeout(e),e=setTimeout(L,p.willEndTimeout)}}(),L=function(e){void 0===e&&(e=!1),p.isStarted&&(p.isMomentum&&e?b({isEnding:!0,isMomentumCancel:!0}):b({isEnding:!0}),p.isMomentum=!1,p.isStarted=!1)},V=function(e){var t=[],n=function(n){n.removeEventListener("wheel",e),t=t.filter(function(e){return e!==n})};return i({observe:function(i){return i.addEventListener("wheel",e,{passive:!1}),t.push(i),function(){return n(i)}},unobserve:n,disconnect:function(){t.forEach(n)}})}(g),F=V.observe,C=V.unobserve,X=V.disconnect;return x(u),i({on:f,off:v,observe:F,unobserve:C,disconnect:X,feedWheel:g,updateOptions:x})}var c={active:!0,breakpoints:{},wheelDraggingClass:"is-wheel-dragging",forceWheelAxis:void 0,target:void 0};function l(e){var t;void 0===e&&(e={});var n=function(){};return{name:"wheelGestures",options:e,init:function(i,o){var r,a,s=o.mergeOptions,m=o.optionsAtMedia,f=s(c,l.globalOptions),v=s(f,e);t=m(v);var d,h=i.internalEngine(),p=null!=(r=t.target)?r:i.containerNode().parentNode,M=null!=(a=t.forceWheelAxis)?a:h.options.axis,g=u({preventWheelAction:M,reverseSign:[!0,!0,!1]}),x=g.observe(p),b=g.on("wheel",function(e){var i=e.axisDelta,o=i[0],r=i[1],a="x"===M?o:r,s="x"===M?r:o,u=e.isMomentum&&e.previous&&!e.previous.isMomentum,c=e.isEnding&&!e.isMomentum||u;Math.abs(a)>Math.abs(s)&&!E&&!e.isMomentum&&function(e){try{y(d=new MouseEvent("mousedown",e.event))}catch(i){return n()}E=!0,document.documentElement.addEventListener("mousemove",S,!0),document.documentElement.addEventListener("mouseup",S,!0),void document.documentElement.addEventListener("mousedown",S,!0),t.wheelDraggingClass&&p.classList.add(t.wheelDraggingClass)}(e);if(!E)return;c?function(e){E=!1,y(D("mouseup",e)),w(),t.wheelDraggingClass&&p.classList.remove(t.wheelDraggingClass)}(e):y(D("mousemove",e))}),E=!1;function w(){document.documentElement.removeEventListener("mousemove",S,!0),document.documentElement.removeEventListener("mouseup",S,!0),document.documentElement.removeEventListener("mousedown",S,!0)}function S(e){E&&e.isTrusted&&e.stopImmediatePropagation()}function D(e,t){var n,i;if(M===h.options.axis){var o=t.axisMovement;n=o[0],i=o[1]}else{var r=t.axisMovement;i=r[0],n=r[1]}if(!h.options.skipSnaps&&!h.options.dragFree){var a=h.containerRect.width,s=h.containerRect.height;n=n<0?Math.max(n,-a):Math.min(n,a),i=i<0?Math.max(i,-s):Math.min(i,s)}return new MouseEvent(e,{clientX:d.clientX+n,clientY:d.clientY+i,screenX:d.screenX+n,screenY:d.screenY+i,movementX:n,movementY:i,button:0,bubbles:!0,cancelable:!0,composed:!0})}function y(e){i.containerNode().dispatchEvent(e)}n=function(){x(),b(),w()}},destroy:function(){return n()}}}l.globalOptions=void 0;export{l as WheelGesturesPlugin};
