import{d as e,e as l,c as t,f as a,N as r,l as i,z as o,o as s,y as n,h as u,j as d,A as c,H as p,I as v,O as m,r as f,a as g,E as x,F as y,B as h,a8 as k,w as b,_ as w}from"./UvJT4o6g.js";import{_ as j}from"./CBbHkZKl.js";import{_ as C}from"./BCo6x5W8.js";import"./DzawaOjK.js";import"./D8sKpr_H.js";import"./DnCr5V3S.js";import"./DSIHSQkF.js";import"./C0AU5oYb.js";import"./_F_G4MiH.js";import"./DPriY4SE.js";import"./D8G5jBss.js";import"./DuiDOSND.js";import"./hr3-BYmJ.js";const z={class:"mb-4"},M={key:0,class:"text-red-500"},F=["multiple","disabled","accept"],B={class:"aspect-square flex flex-col"},L={class:"bg-gray-100 dark:bg-gray-800 flex items-center justify-center flex-grow"},$=["src","alt"],U={key:1,class:"w-full h-full flex flex-col items-center justify-center p-2 text-gray-500 dark:text-gray-400"},A={class:"text-xs text-center truncate w-full px-1"},D={class:"p-2 bg-white dark:bg-gray-800 max-h-40"},R={class:"text-xs font-medium text-gray-900 dark:text-white truncate"},S={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},I={key:1,class:"text-xs text-gray-500 dark:text-gray-400 truncate"},V={class:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center space-y-2"},_=["onClick"],P={class:"flex items-center gap-3"},H=["onClick"],E=["onClick"],W={class:"aspect-square flex flex-col"},q={class:"bg-gray-100 dark:bg-gray-800 flex items-center justify-center flex-grow"},O=["src","alt"],G={key:1,class:"w-full h-full flex flex-col items-center justify-center p-2 text-gray-500 dark:text-gray-400"},N={class:"text-xs text-center truncate w-full px-1"},K={class:"p-2 bg-white dark:bg-gray-800 max-h-40"},J={class:"text-xs font-medium text-gray-900 dark:text-white truncate"},T={class:"text-xs text-gray-500 dark:text-gray-400"},Y={class:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center space-y-2"},Z=["onClick"],Q={class:"flex items-center gap-3"},X=["onClick"],ee=["onClick"],le={key:0,class:"mt-2 text-sm text-red-600 dark:text-red-400"},te={class:"flex-1 flex items-center justify-center p-4"},ae=["src","alt"],re=["src"],ie={key:2,class:"text-center"},oe={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},se={class:"mt-6"},ne={class:"text-sm text-gray-500 dark:text-gray-400"},ue=C(e({__name:"CustomFileUpload",props:{modelValue:{default:null},name:{default:"files"},label:{default:"Upload files"},multiple:{type:Boolean,default:!1},accept:{default:"*"},required:{type:Boolean,default:!1},maxSize:{default:10},maxFiles:{default:5},icon:{default:null},disabled:{type:Boolean,default:!1},thumbnailSize:{default:120},thumbnailFit:{default:"cover"},forceCustom:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:C}){const ue=e,de=C,ce=l(null),pe=l(null),ve=l([]),me=l([]),fe=l(null),ge=l(!1),xe=l(null),ye=l(null),he=t(()=>(ue.multiple,me.value.length>0||ve.value.length>0)),ke=t(()=>[...me.value,...ve.value]),be=e=>{if(ue.disabled)return;const l=e.target,t=l.files?Array.from(l.files):[];if(null!==xe.value&&ye.value){if(t.length>0){const e=t[0];if(fe.value=null,ue.maxSize&&e.size>1024*ue.maxSize*1024)return void(fe.value=`File ${e.name} exceeds maximum size of ${ue.maxSize}MB`);if("*"!==ue.accept&&!je(e,ue.accept))return void(fe.value=`File ${e.name} is not an accepted file type`);"existing"===ye.value?(me.value.splice(xe.value,1),ve.value.splice(xe.value,0,e)):ve.value.splice(xe.value,1,e),Me()}}else we(t);l&&(l.value=""),xe.value=null,ye.value=null},we=e=>{if(ue.disabled)return;if(fe.value=null,ue.multiple||(me.value=[],ve.value=[]),ue.multiple&&ue.maxFiles&&e.length+ke.value.length>ue.maxFiles)return void(fe.value=`You can upload maximum ${ue.maxFiles} files`);const l=ue.multiple?e:e.slice(0,1);for(const t of l){if(ue.maxSize&&t.size>1024*ue.maxSize*1024)return void(fe.value=`File ${t.name} exceeds maximum size of ${ue.maxSize}MB`);if("*"!==ue.accept&&!je(t,ue.accept))return void(fe.value=`File ${t.name} is not an accepted file type`)}ve.value=[...ve.value,...l],Me()},je=(e,l)=>l.split(",").map(e=>e.trim()).some(l=>l.startsWith(".")?e.name.toLowerCase().endsWith(l.toLowerCase()):e.type.match(l.replace("*",".*"))),Ce=()=>{!ue.disabled&&ce.value&&ce.value.click()},ze=(e,l)=>{ue.disabled||(xe.value=e,ye.value=l,Ce())},Me=()=>{if(ue.multiple){const e=[...me.value,...ve.value];de("update:modelValue",e),de("change",e)}else{const e=[...me.value,...ve.value],l=e.length>0?e[0]:null;de("update:modelValue",l),de("change",l)}},Fe=e=>{var l;return decodeURIComponent((null==(l=e.split("/").pop())?void 0:l.split("?")[0])||"file")},Be=e=>e.type.startsWith("image/"),Le=e=>(console.log("getPreviewUrl",e),URL.createObjectURL(e)),$e=e=>{if(0===e)return"0 Bytes";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["Bytes","KB","MB","GB"][l]};a(()=>ue.modelValue,e=>{(e=>{if(ve.value=[],me.value=[],e)if(ue.multiple)(Array.isArray(e)?e:[e]).forEach(e=>{e instanceof File?ve.value.push(e):"string"==typeof e?me.value.push({url:e,name:Fe(e)}):e&&"object"==typeof e&&(e.file?ve.value.push(e.file):e.url&&me.value.push(e))});else if(e instanceof File)ve.value=[e];else if("string"==typeof e)me.value=[{url:e,name:Fe(e)}];else if(e&&"object"==typeof e&&!Array.isArray(e)){const l=e;l.file?ve.value=[l.file]:l.url&&(me.value=[l])}})(e)},{immediate:!0,deep:!0}),r(()=>{ve.value.forEach(e=>{Be(e)&&URL.revokeObjectURL(Le(e))})});const Ue=e=>{var l;return(null==(l=e.split(".").pop())?void 0:l.toUpperCase())||"FILE"},Ae=l(!1),De=l(null),Re=t(()=>{var e;return!!(null==(e=De.value)?void 0:e.type)&&["image/jpeg","image/png","image/gif","image/webp"].includes(De.value.type)}),Se=t(()=>{var e;return"application/pdf"===(null==(e=De.value)?void 0:e.type)}),Ie=t(()=>{var e;if(!(null==(e=De.value)?void 0:e.type))return"Unknown file type";return{"image/jpeg":"JPEG Image","image/png":"PNG Image","image/gif":"GIF Image","image/webp":"WebP Image","application/pdf":"PDF Document","application/msword":"Word Document","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"Word Document"}[De.value.type]||De.value.type}),Ve=e=>{De.value="url"in e?{url:e.url,name:e.name||Fe(e.url),type:_e(e.url)}:{url:e instanceof File?URL.createObjectURL(e):"",name:e.name,type:e.type},Ae.value=!0},_e=e=>{var l;return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",webp:"image/webp",pdf:"application/pdf",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}[(null==(l=e.split(".").pop())?void 0:l.toLowerCase())||""]||"application/octet-stream"};return i(()=>{var e;(null==(e=De.value)?void 0:e.url)&&!("url"in De.value)&&URL.revokeObjectURL(De.value.url)}),(e,l)=>{var t,a;const r=x,i=w,C=j;return s(),o("div",{class:c(["file-upload-container",{"opacity-75 pointer-events-none":e.disabled}])},[n("div",z,[n("label",{class:c(["block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",{"text-gray-400 dark:text-gray-500":e.disabled}])},[p(v(e.label)+" ",1),e.required?(s(),o("span",M,"*")):d("",!0)],2),n("div",{ref_key:"dropZone",ref:pe,class:c(["border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 transition-colors",{"border-primary bg-primary/10":ge.value,"hover:border-primary":!ge.value&&!he.value&&!e.disabled,"bg-gray-100 dark:bg-gray-800":e.disabled}]),onDragover:l[1]||(l[1]=m(l=>{return!e.disabled&&(t=l,void(ue.disabled||(t.preventDefault(),ge.value=!0)));var t},["prevent"])),onDragleave:l[2]||(l[2]=m(l=>{return!e.disabled&&(t=l,void(ue.disabled||(t.preventDefault(),ge.value=!1)));var t},["prevent"])),onDrop:l[3]||(l[3]=m(l=>!e.disabled&&(e=>{var l;if(ue.disabled)return;e.preventDefault(),ge.value=!1;const t=null==(l=e.dataTransfer)?void 0:l.files;if(t&&t.length>0)if(null!==xe.value&&ye.value){const e=Array.from(t);if(e.length>0){const l=e[0];"existing"===ye.value?(me.value.splice(xe.value,1),ve.value.splice(xe.value,0,l)):ve.value.splice(xe.value,1,l),Me()}xe.value=null,ye.value=null}else we(Array.from(t))})(l),["prevent"]))},[n("input",{type:"file",ref_key:"fileInput",ref:ce,multiple:e.multiple,disabled:e.disabled,accept:e.accept,class:"hidden",onChange:be},null,40,F),!he.value||e.forceCustom?(s(),o("div",{key:0,onClick:l[0]||(l[0]=l=>!e.disabled&&Ce())},[e.$slots.icon?f(e.$slots,"icon",{key:0,icon:e.icon,files:[...me.value,...null==(t=ve.value)?void 0:t.map(e=>({url:Le(e),...e}))]},void 0,!0):(s(),o("div",{key:1,class:c(["flex flex-col items-center justify-center py-8",{"cursor-pointer":!e.disabled}])},[e.icon?(s(),g(r,{key:0,name:e.icon,class:c(e.disabled?"text-gray-400 dark:text-gray-600":"text-gray-400 dark:text-gray-500")},null,8,["name","class"])):(s(),o("svg",{key:1,class:c(["size-12",e.disabled?"text-gray-400 dark:text-gray-600":"text-gray-400 dark:text-gray-500"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},l[6]||(l[6]=[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"},null,-1)]),2)),n("p",{class:c(["mt-2 text-sm",e.disabled?"text-gray-500 dark:text-gray-600":"text-gray-600 dark:text-gray-400"])},[l[7]||(l[7]=p(" Drag and drop files here, or ")),n("span",{class:c(e.disabled?"text-gray-500":"text-primary cursor-pointer")},"click to browse",2)],2),n("p",{class:c(["text-xs mt-1",e.disabled?"text-gray-500 dark:text-gray-600":"text-gray-500 dark:text-gray-400"])}," Supported formats: "+v("*"===e.accept?"Any file type":e.accept),3)],2))])):(s(),o("div",{key:1,class:c([ue.multiple?"grid gap-4 grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5":"flex items-center justify-center"])},[(s(!0),o(y,null,h(me.value,(t,a)=>{return s(),o("div",{key:"existing-"+a,class:"relative group rounded-md overflow-hidden border border-gray-200 dark:border-gray-700",style:k({"max-width":`${e.thumbnailSize}px`,"max-height":`${e.thumbnailSize}px`})},[n("div",B,[n("div",L,[(r=t.url,/\.(jpg|jpeg|png|gif|webp|svg)$/i.test(r)?(s(),o("img",{key:0,src:t.url,class:"w-full h-full object-cover",style:k({"object-fit":e.thumbnailFit}),alt:t.name||"Preview"},null,12,$)):(s(),o("div",U,[l[8]||(l[8]=n("svg",{class:"w-10 h-10 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),n("span",A,v(Ue(t.url)),1)])))]),n("div",D,[n("p",R,v(t.name||Fe(t.url)),1),t.size?(s(),o("p",S,v($e(t.size)??"-"),1)):(s(),o("p",I,v(t.url??"-"),1))])]),n("div",V,[n("button",{class:"text-white p-2 rounded-full hover:bg-white/20 transition-colors",title:"Preview",onClick:m(e=>Ve(t),["stop"])},l[9]||(l[9]=[n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)]),8,_),n("div",P,[ue.disabled?d("",!0):(s(),o("button",{key:0,class:"text-white p-2 rounded-full hover:bg-white/20 transition-colors",title:"Replace",onClick:m(e=>ze(a,"existing"),["stop"])},l[10]||(l[10]=[n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536M9 11l6.586-6.586a2 2 0 112.828 2.828L11.828 13.828a2 2 0 01-.828.515L7 15l1.657-3.828a2 2 0 01.515-.828z"})],-1)]),8,H)),ue.disabled?d("",!0):(s(),o("button",{key:1,class:"text-white p-2 rounded-full hover:bg-white/20 transition-colors",title:"Remove",onClick:m(e=>(e=>{ue.disabled||(me.value.splice(e,1),Me())})(a),["stop"])},l[11]||(l[11]=[n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,E))])])],4);var r}),128)),(s(!0),o(y,null,h(ve.value,(t,a)=>(s(),o("div",{key:"new-"+a,class:"relative group rounded-md overflow-hidden border border-gray-200 dark:border-gray-700",style:k({"max-width":`${e.thumbnailSize}px`,"max-height":`${e.thumbnailSize}px`})},[n("div",W,[n("div",q,[Be(t)?(s(),o("img",{key:0,src:Le(t),class:"w-full h-full",style:k({"object-fit":e.thumbnailFit}),alt:t.name},null,12,O)):(s(),o("div",G,[l[12]||(l[12]=n("svg",{class:"w-10 h-10 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),n("span",N,v(Ue(t.name)),1)]))]),n("div",K,[n("p",J,v(t.name),1),n("p",T,v($e(t.size)??"-"),1)])]),n("div",Y,[n("button",{class:"text-white p-2 rounded-full hover:bg-white/20 transition-colors",title:"Preview",onClick:m(e=>Ve(t),["stop"])},l[13]||(l[13]=[n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)]),8,Z),n("div",Q,[ue.disabled?d("",!0):(s(),o("button",{key:0,class:"text-white p-2 rounded-full hover:bg-white/20 transition-colors",title:"Replace",onClick:m(e=>ze(a,"new"),["stop"])},l[14]||(l[14]=[n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536M9 11l6.586-6.586a2 2 0 112.828 2.828L11.828 13.828a2 2 0 01-.828.515L7 15l1.657-3.828a2 2 0 01.515-.828z"})],-1)]),8,X)),ue.disabled?d("",!0):(s(),o("button",{key:1,class:"text-white p-2 rounded-full hover:bg-white/20 transition-colors",title:"Remove",onClick:m(e=>(e=>{ue.disabled||(ve.value.splice(e,1),Me())})(a),["stop"])},l[15]||(l[15]=[n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,ee))])])],4))),128)),e.multiple&&!e.disabled?(s(),o("div",{key:0,class:"aspect-square border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-md flex items-center justify-center cursor-pointer hover:border-primary transition-colors",onClick:Ce},l[16]||(l[16]=[n("div",{class:"text-center p-4"},[n("svg",{class:"w-8 h-8 mx-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})]),n("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Add files ")],-1)]))):d("",!0)],2))],34),fe.value?(s(),o("p",le,v(fe.value),1)):d("",!0)]),u(C,{open:Ae.value,"onUpdate:open":l[5]||(l[5]=e=>Ae.value=e),ui:{width:"sm:max-w-4xl",footer:"justify-between"},title:(null==(a=De.value)?void 0:a.name)||"File Preview"},{body:b(()=>{var e,t,a,c,p;return[n("div",te,[Re.value?(s(),o("img",{key:0,src:null==(e=De.value)?void 0:e.url,alt:null==(t=De.value)?void 0:t.name,class:"max-h-[70vh] max-w-full object-contain rounded-md"},null,8,ae)):Se.value?(s(),o("iframe",{key:1,src:`${null==(a=De.value)?void 0:a.url}#view=fitH`,class:"w-full h-[70vh] border-none rounded-md",frameborder:"0"},null,8,re)):(s(),o("div",ie,[u(r,{name:"i-heroicons-document-text",class:"mx-auto h-12 w-12 text-gray-400"}),n("h3",oe,v((null==(c=De.value)?void 0:c.name)||"File"),1),l[17]||(l[17]=n("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," No preview available ",-1)),n("div",se,[(null==(p=De.value)?void 0:p.url)?(s(),g(i,{key:0,label:"Download File",color:"primary",variant:"solid",to:De.value.url,target:"_blank",download:""},null,8,["to"])):d("",!0)])]))])]}),footer:b(()=>[n("p",ne,v(Ie.value),1),u(i,{label:"Close",color:"neutral",variant:"ghost",onClick:l[4]||(l[4]=e=>Ae.value=!1)})]),_:1},8,["open","title"])],2)}}}),[["__scopeId","data-v-c2d632b3"]]);export{ue as default};
