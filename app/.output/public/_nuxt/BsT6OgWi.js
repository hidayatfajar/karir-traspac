import{az as e,V as a,aw as s,aA as n,e as l,n as o}from"./UvJT4o6g.js";const t=e.create({baseURL:"https://lms-sttal.dev-app.online/s22-api/lms-sttal-api/index.php",timeout:6e5});function r(){const e=n("toasts",()=>[]),a=l(!1),s=[];return{toasts:e,add:function(n){const l={id:`${Date.now()}-${Math.random().toString(36).slice(2,9)}`,open:!0,...n};return s.push(l),async function(){if(!a.value&&0!==s.length){for(a.value=!0;s.length>0;){const a=s.shift();await o(),e.value=[...e.value,a].slice(-5)}a.value=!1}}(),l},update:function(a,s){const n=e.value.findIndex(e=>e.id===a);-1!==n&&(e.value[n]={...e.value[n],...s})},remove:function(a){const s=e.value.findIndex(e=>e.id===a);-1!==s&&(e.value[s]={...e.value[s],open:!1}),setTimeout(()=>{e.value=e.value.filter(e=>e.id!==a)},200)},clear:function(){e.value=[]}}}t.interceptors.request.use(function(e){const n=a(),{loading:l,user:o}=s(n);return l.value=!0,o.value&&o.value.token&&e.headers.set("TTOKEN",o.value.token),e}),t.interceptors.response.use(e=>{const n=a();if(n){const{loading:e}=s(n);setTimeout(()=>{e.value=!1},1e3)}return e},async e=>{var n,l,o,t,r,u,i,d,c,v,p,m,k;const g=a();if(g){const{loading:e}=s(g);e.value=!1}if(!(null==e?void 0:e.response))return e.response={data:{code:500,message:"Server dalam perbaikan.",data:null,errors:null}},Promise.reject(e);if(!(null==(l=null==(n=null==e?void 0:e.message)?void 0:n.toLowerCase())?void 0:l.includes("network"))){switch(parseInt((null==e?void 0:e.response)&&(null==(t=null==e?void 0:e.response)?void 0:t.status))){case 401:e.response.data={...null==(r=e.response)?void 0:r.data,code:401,message:"Anda belum login atau token sudah kadaluarsa, silahkan login terlebih dahulu.",data:null,errors:null},null==(u=a())||u.logout();break;case 403:e.response.data={...null==(i=e.response)?void 0:i.data,code:403,message:"Anda tidak memiliki akses ke halaman ini.",data:null,errors:null},$router.push({path:"/no-access"});break;case 502:e.response.data={...null==(d=e.response)?void 0:d.data,code:502,message:"Aplikasi sedang tidak terkoneksi ke server.",data:null,errors:null};break;case 413:e.response.data={...null==(c=e.response)?void 0:c.data,code:413,message:"File gagal diunggah.",data:null,errors:null};break;case 500:e.response.data={...null==(v=e.response)?void 0:v.data,code:500,message:((null==(p=null==e?void 0:e.response)?void 0:p.error)??(null==(k=null==(m=null==e?void 0:e.response)?void 0:m.data)?void 0:k.message))||"Server dalam perbaikan.",data:null,errors:null}}return Promise.reject(e)}e.response.data={...null==(o=e.response)?void 0:o.data,code:503,message:"Koneksi bermasalah, silakan cek koneksi internet.",data:null,errors:null}});export{t as r,r as u};
