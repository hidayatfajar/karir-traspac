import{m as e,u as t,k as n,g as o,n as r,p as a,q as u,i as s}from"./qiqiReYZ.js";import{d as i,y as l,a7 as c,a5 as d,J as f,e as p,f as v,g as m,m as y,v as g,P as h,w as b,I as w,c as E,ap as A}from"./Cv-82GME.js";import{g as S}from"./_F_G4MiH.js";import{i as F}from"./L1kicMpx.js";const L=e(()=>i([]));function N(e,t){const n=[...e],o=n.indexOf(t);return-1!==o&&n.splice(o,1),n}const T="focusScope.autoFocusOnMount",M="focusScope.autoFocusOnUnmount",B={bubbles:!1,cancelable:!0};function W(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function k(e,t){for(const n of e)if(!C(n,{upTo:t}))return n}function C(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==t&&e===t)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function I(e,{select:t=!1}={}){if(e&&e.focus){const n=S();e.focus({preventScroll:!0}),e!==n&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&t&&e.select()}}const P=l({__name:"FocusScope",props:{loop:{type:Boolean,default:!1},trapped:{type:Boolean,default:!1},asChild:{type:Boolean},as:{}},emits:["mountAutoFocus","unmountAutoFocus"],setup(e,{emit:o}){const r=e,a=o,{currentRef:u,currentElement:s}=t(),l=i(null),b=function(){const e=L();return{add(t){const n=e.value[0];t!==n&&(null==n||n.pause()),e.value=N(e.value,t),e.value.unshift(t)},remove(t){var n;e.value=N(e.value,t),null==(n=e.value[0])||n.resume()}}}(),w=c({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}});function E(e){if(!r.loop&&!r.trapped)return;if(w.paused)return;const t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,n=S();if(t&&n){const t=e.currentTarget,[o,a]=function(e){const t=W(e);return[k(t,e),k(t.reverse(),e)]}(t);o&&a?e.shiftKey||n!==a?e.shiftKey&&n===o&&(e.preventDefault(),r.loop&&I(a,{select:!0})):(e.preventDefault(),r.loop&&I(o,{select:!0})):n===t&&e.preventDefault()}}return d(e=>{if(!n)return;const t=s.value;if(!r.trapped)return;function o(e){if(w.paused||!t)return;const n=e.target;t.contains(n)?l.value=n:I(l.value,{select:!0})}function a(e){if(w.paused||!t)return;const n=e.relatedTarget;null!==n&&(t.contains(n)||I(l.value,{select:!0}))}document.addEventListener("focusin",o),document.addEventListener("focusout",a);const u=new MutationObserver(function(e){t.contains(l.value)||I(t)});t&&u.observe(t,{childList:!0,subtree:!0}),e(()=>{document.removeEventListener("focusin",o),document.removeEventListener("focusout",a),u.disconnect()})}),d(async e=>{const t=s.value;if(await f(),!t)return;b.add(w);const n=S();if(!t.contains(n)){const e=new CustomEvent(T,B);t.addEventListener(T,e=>a("mountAutoFocus",e)),t.dispatchEvent(e),e.defaultPrevented||(!function(e,{select:t=!1}={}){const n=S();for(const o of e)if(I(o,{select:t}),S()!==n)return!0}((o=W(t),o.filter(e=>"A"!==e.tagName)),{select:!0}),S()===n&&I(t))}var o;e(()=>{t.removeEventListener(T,e=>a("mountAutoFocus",e));const e=new CustomEvent(M,B),o=e=>{a("unmountAutoFocus",e)};t.addEventListener(M,o),t.dispatchEvent(e),setTimeout(()=>{e.defaultPrevented||I(n??document.body,{select:!0}),t.removeEventListener(M,o),b.remove(w)},0)})}),(e,t)=>(v(),p(g(h),{ref_key:"currentRef",ref:u,tabindex:"-1","as-child":e.asChild,as:e.as,onKeydown:E},{default:m(()=>[y(e.$slots,"default")]),_:3},8,["as-child","as"]))}});var R=new WeakMap,_=new WeakMap,x={},D=0,K=function(e){return e&&(e.host||K(e.parentNode))},O=function(e,t,n,o){var r=function(e,t){return t.map(function(t){if(e.contains(t))return t;var n=K(t);return n&&e.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",e,". Doing nothing"),null)}).filter(function(e){return Boolean(e)})}(t,Array.isArray(e)?e:[e]);x[n]||(x[n]=new WeakMap);var a=x[n],u=[],s=new Set,i=new Set(r),l=function(e){e&&!s.has(e)&&(s.add(e),l(e.parentNode))};r.forEach(l);var c=function(e){e&&!i.has(e)&&Array.prototype.forEach.call(e.children,function(e){if(s.has(e))c(e);else try{var t=e.getAttribute(o),r=null!==t&&"false"!==t,i=(R.get(e)||0)+1,l=(a.get(e)||0)+1;R.set(e,i),a.set(e,l),u.push(e),1===i&&r&&_.set(e,!0),1===l&&e.setAttribute(n,"true"),r||e.setAttribute(o,"true")}catch(d){console.error("aria-hidden: cannot operate on ",e,d)}})};return c(t),s.clear(),D++,function(){u.forEach(function(e){var t=R.get(e)-1,r=a.get(e)-1;R.set(e,t),a.set(e,r),t||(_.has(e)||e.removeAttribute(o),_.delete(e)),r||e.removeAttribute(n)}),--D||(R=new WeakMap,R=new WeakMap,_=new WeakMap,x={})}},j=function(e,t,n){void 0===n&&(n="data-aria-hidden");var o=Array.from(Array.isArray(e)?e:[e]),r=function(e){return"undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body}(e);return r?(o.push.apply(o,Array.from(r.querySelectorAll("[aria-live], script"))),O(o,r,n,"aria-hidden")):function(){return null}};function H(e){let t;b(()=>o(e),e=>{e?t=j(e):t&&t()}),w(()=>{t&&t()})}const $=r(()=>{const e=i(new Map),t=i(),o=E(()=>{for(const t of e.value.values())if(t)return!0;return!1}),r=F({scrollBody:i(!0)});let a=null;return b(o,(e,o)=>{var i;if(!n)return;if(!e)return void(o&&(document.body.style.paddingRight="",document.body.style.marginRight="",document.body.style.pointerEvents="",document.documentElement.style.removeProperty("--scrollbar-width"),document.body.style.overflow=t.value??"",u&&(null==a||a()),t.value=void 0));void 0===t.value&&(t.value=document.body.style.overflow);const l=window.innerWidth-document.documentElement.clientWidth,c={padding:l,margin:0},d=(null==(i=r.scrollBody)?void 0:i.value)?"object"==typeof r.scrollBody.value?A({padding:!0===r.scrollBody.value.padding?l:r.scrollBody.value.padding,margin:!0===r.scrollBody.value.margin?l:r.scrollBody.value.margin},c):c:{padding:0,margin:0};l>0&&(document.body.style.paddingRight="number"==typeof d.padding?`${d.padding}px`:String(d.padding),document.body.style.marginRight="number"==typeof d.margin?`${d.margin}px`:String(d.margin),document.documentElement.style.setProperty("--scrollbar-width",`${l}px`),document.body.style.overflow="hidden"),u&&(a=s(document,"touchmove",e=>function(e){const t=e||window.event,n=t.target;if(n instanceof Element&&Y(n))return!1;if(t.touches.length>1)return!0;t.preventDefault&&t.cancelable&&t.preventDefault();return!1}(e),{passive:!1})),f(()=>{document.body.style.pointerEvents="none",document.body.style.overflow="hidden"})},{immediate:!0,flush:"sync"}),e});function X(e){const t=Math.random().toString(36).substring(2,7),n=$();n.value.set(t,e??!1);const o=E({get:()=>n.value.get(t)??!1,set:e=>n.value.set(t,e)});return a(()=>{n.value.delete(t)}),o}function Y(e){const t=window.getComputedStyle(e);if("scroll"===t.overflowX||"scroll"===t.overflowY||"auto"===t.overflowX&&e.clientWidth<e.scrollWidth||"auto"===t.overflowY&&e.clientHeight<e.scrollHeight)return!0;{const t=e.parentNode;return t instanceof Element&&"BODY"!==t.tagName&&Y(t)}}export{P as _,H as a,X as u};
